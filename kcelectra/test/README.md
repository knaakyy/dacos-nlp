# π§ KcELECTRA λ¶„λ¥ μ„±λ¥ κ°μ„  μ‹¤ν—

> **μ¤νƒ(FP)** κ³Ό **λ―Ένƒ(FN)** μ„ μ¤„μ—¬ μ „μ²΄ λ¶„λ¥ μ„±λ¥μ„ κ°μ„ ν•κΈ° μ„ν• μ‹¤ν—λ“¤

### μ©μ–΄ μ •λ¦¬
- **μ¤νƒ(FP, False Positive)**: μ •μƒ λ¬Έμ¥μ„ μ•…μ„±μΌλ΅ μλ» λ¶„λ¥
- **λ―Ένƒ(FN, False Negative)**: μ•…μ„± λ¬Έμ¥μ„ μ •μƒμΌλ΅ μλ» λ¶„λ¥

### λ©ν‘
- **μ¤νƒ(FP)** κ³Ό **λ―Ένƒ(FN)** μ„ λ™μ‹μ— μ¤„μΈλ‹¤.
- λ‹¨μ Accuracyκ°€ μ•„λ‹ **Precision/Recall κ· ν•**, **F1 Score** λ¥Ό ν•¨κ» κ΄€λ¦¬ν•λ‹¤.
- νΉν **λ³€ν• μ•μ„¤(μ΄μ„±, μ«μ μΉν™ λ“±)** νƒμ§€μ¨μ„ λ†’μΈλ‹¤.

---

## π“‹ μ‹¤ν— λ©λ΅

| μ‹¤ν— ID | νμΌλ… | λ³€κ²½ μ‚¬ν•­ | κΈ°λ€ ν¨κ³Ό |
|---------|--------|----------|----------|
| **E1** | `E1_threshold_tuning.ipynb` | threshold μ¤μ• (0.1~0.95) | FP/FN κ· ν• μ΅°μ  (μ¬ν•™μµ μ—†μ΄) |
| **E2** | `E2_precision_metric.ipynb` | metric_for_best_model = precision | Precision β†‘, FP β†“ |
| **E3** | `E3_loss_weight_FP.ipynb` | class_weights μ΅°μ • | FP/FN λ²μ  μ΅°μ • |
| **E4** | `E4_data_augmentation.ipynb` | LOL μ•μ„¤ + νΉμλ¬Έμ μ •μƒ λ°μ΄ν„° μ¦κ°• | μΌλ° μ•μ„¤ νƒμ§€β†‘, FPβ†“ |
| **E5** | (μμ •) | E4 + κ°€μ¤‘μΉ λ°μ (1:5) | ν¬μ† ν΄λμ¤ λ³΄μ • |

---

## π€ ν„μ¬ μ‹¤ν— μ¤‘μΈ λ‚΄μ©

```
1. E4 (λ°μ΄ν„° μ¦κ°•) - LOL μ•μ„¤ + νΉμλ¬Έμ μ •μƒ
   β†“
2. E5 (E4 + κ°€μ¤‘μΉ 1:5) - E4κ°€ μ λ‚μ¤λ©΄
   β†“
3. Threshold νλ‹ (0.7 κΈ°μ¤€)
```

---

## π“‚ ν΄λ” κµ¬μ΅°

```
test/
β”β”€β”€ README.md                    # μ΄ νμΌ
β”β”€β”€ λ¨λΈλΉ„κµ_ν…μ¤νΈ.ipynb         # λ¨λΈ λΉ„κµ ν‰κ°€ (ν…μ¤νΈ λ¬Έμ¥)
β”β”€β”€ E1_threshold_tuning.ipynb    # μ‹¤ν— 1: Threshold μ¤μ•
β”β”€β”€ E2_precision_metric.ipynb    # μ‹¤ν— 2: Precision κΈ°μ¤€
β”β”€β”€ E3_loss_weight_FP.ipynb      # μ‹¤ν— 3: Loss κ°€μ¤‘μΉ μ΅°μ •
β”‚
β”β”€β”€ E1_output/                   # E1 κ²°κ³Όλ¬Ό (μλ™ μƒμ„±)
β”‚   β”β”€β”€ best_model/
β”‚   β””β”€β”€ threshold_sweep_results.csv
β”β”€β”€ E2_output/                   # E2 κ²°κ³Όλ¬Ό (μλ™ μƒμ„±)
β”‚   β””β”€β”€ best_model/
β””β”€β”€ E3_output/                   # E3 κ²°κ³Όλ¬Ό (μλ™ μƒμ„±)
    β””β”€β”€ best_model_E3-?/
```

---

## π“ μ‹¤ν— λΉ„κµν‘ (Validation κΈ°μ¤€)

| μ‹¤ν— | FP (μ¤νƒ) | FN (λ―Ένƒ) | Precision | Recall | F1 | λΉ„κ³  |
|------|-----------|-----------|-----------|--------|-----|------|
| κΈ°μ΅΄ (baseline) | - | - | 93.21% | 89.78% | 91.46% | KcElectra_ν•™μµ.ipynb, AUC=98.09% |
| E1 (th=0.5) | 247 | 287 | 92.70% | 91.63% | 92.16% | FPR=5.40% |
| E1 (th=0.90) | 79 | 594 | 97.28% | 82.65% | 89.37% | FPR=1.73%, FPμµμ†(Recallβ‰¥0.8) |
| E2 (precision) | 223 | 358 | 93.22% | 89.54% | 91.35% | AUC=98.07% |
| E4 (λ°μ΄ν„°μ¦κ°•) | 247 | 331 | 95.81% | 94.46% | 95.13% | AUC=98.88%, LOLμ•μ„¤+νΉμλ¬Έμμ •μƒ |
| E5 (E4+κ°€μ¤‘μΉ) | 222 | 378 | 96.19% | 93.68% | 94.92% | AUC=98.70%, class_weight=[4,1] |

---

## β οΈ μ£Όμμ‚¬ν•­

1. **λ°μ΄ν„° κ²½λ΅**: κ° λ…ΈνΈλ¶μ—μ„ `DATA_DIR`μ΄ `../data`λ΅ μ„¤μ •λμ–΄ μμ
2. **GPU κ¶μ¥**: ν•™μµμ— μ‹κ°„μ΄ μ¤λ κ±Έλ¦¬λ―€λ΅ GPU ν™κ²½ κ¶μ¥
3. **μ‹¤ν— μμ„**: E1μ€ μ¬ν•™μµ μ—†μ΄ λΉ λ¥΄κ² ν…μ¤νΈ κ°€λ¥, E2/E3λ” μ¬ν•™μµ ν•„μ”

---

## π“ κ²°κ³Ό κΈ°λ΅ ν…ν”λ¦Ώ

```markdown
#### μ‹¤ν— ID: E?
- λ³€κ²½ μ‚¬ν•­:
  - (μ) threshold 0.5β†’0.72
  - (μ) class weight [1.5, 0.5]
- Validation μ„±λ¥:
  - FP(μ¤νƒ, μ •μƒβ†’μ•…μ„±): 
  - FN(λ―Ένƒ, μ•…μ„±β†’μ •μƒ): 
  - Precision:
  - Recall:
  - F1:
- μ½”λ©νΈ:
  - μ¤νƒ(FP)μ΄ μ£Όλ΅ λ°μƒν• λ¬Έμ¥ μ ν•:
  - λ―Ένƒ(FN)μ΄ μ£Όλ΅ λ°μƒν• λ¬Έμ¥ μ ν•:
```

---

## π”® μ¶”κ°€ μ‹¤ν— κ³„ν (λ―Έκµ¬ν„)

### E6: ν•λ“ μΌ€μ΄μ¤ λ°μ΄ν„° λ³΄κ°•
- **ν•λ“ λ„¤κ±°ν‹°λΈ**: FP μ‚¬λ΅€(μ •μƒμΈλ° μ•/μ€μ–΄/λ° ν¬ν•¨)λ¥Ό μ •μƒ λΌλ²¨λ΅ μ¶”κ°€
- **ν•λ“ ν¬μ§€ν‹°λΈ**: FN μ‚¬λ΅€(λ³€ν• μ•μ„¤)λ¥Ό μ•…μ„± λΌλ²¨λ΅ μ¶”κ°€
- λ©ν‘: κ²½κ³„ μ‚¬λ΅€μ—μ„ λ¶„λ¥ μ„±λ¥ ν–¥μƒ

### E7: λ³€ν• μ•μ„¤ λ°μ΄ν„° μ¦κ°•
- μ΄μ„± λ³€ν™, μ«μ μΉν™(μ‹λ°β†’γ……γ…‚, 18 λ“±) ν¨ν„΄ ν•™μµ κ°•ν™”
- LOL μ•μ„¤ λ°μ΄ν„°(`data/LOL_badwords_all_merged.csv`) μ¶”κ°€
- λ©ν‘: λ³€ν• μ•μ„¤ λ―Ένƒ(FN) κ°μ†

### E8: μΊλ¦¬λΈλ μ΄μ… + threshold μ¬νλ‹
- Temperature scaling λ“±μΌλ΅ κ³Όμ‹  μ™„ν™”
- ν™•λ¥  λ¶„ν¬ λ³΄μ • ν›„ threshold μ¬νλ‹
- λ©ν‘: μ• λ§¤ν• μΌ€μ΄μ¤μ—μ„ λ” μ •ν™•ν• νλ‹¨

---

## π“ λ¨λΈλΉ„κµ_ν…μ¤νΈ.ipynb κ²°κ³Ό

> 27κ° ν…μ¤νΈ λ¬Έμ¥μΌλ΅ ν‰κ°€ν• κ²°κ³Ό (Baseline, E1, E2, E4, E5)

### λ¨λΈ λΉ„κµ μ”μ•½

| λ¨λΈ | Threshold | Accuracy | Precision | Recall | F1 | FP(μ¤νƒ) | FN(λ―Ένƒ) | FPR |
|------|-----------|----------|-----------|--------|-----|---------|---------|-----|
| Baseline | 0.5 | 48.1% | 40.0% | 33.3% | 36.4% | 6 | 8 | 40.0% |
| E1 (Threshold νλ‹) | 0.9 | 40.7% | 16.7% | 8.3% | 11.1% | 5 | 11 | 33.3% |
| E2 (Precision μµμ ν™”) | 0.5 | 44.4% | 33.3% | 25.0% | 28.6% | 6 | 9 | 40.0% |
| E4 (λ°μ΄ν„° μ¦κ°•) | 0.5 | 66.7% | 63.6% | 58.3% | 60.9% | 4 | 5 | 26.7% |
| **E5 (μ¦κ°•+κ°€μ¤‘μΉ)** | 0.5 | **66.7%** | **66.7%** | **50.0%** | **57.1%** | **3** | **6** | **20.0%** |

### μΉ΄ν…κ³ λ¦¬λ³„ μ •ν™•λ„ λΉ„κµ

| μΉ΄ν…κ³ λ¦¬ | κ°μ | Baseline | E1 | E2 | E4 | **E5** |
|----------|------|----------|-----|-----|--------|--------|
| μ •μƒ-μΌλ° | 5 | 80% | 100% | 80% | 80% | **100%** |
| μ •μƒ-ν•λ“λ„¤κ±°ν‹°λΈ | 4 | 75% | 75% | 75% | 75% | **75%** |
| μ •μƒ-ν•λ“μΉ΄μ΄ν„° | 6 | 33% | 33% | 33% | 67% | **67%** |
| μ•…μ„±-μΌλ°μ•μ„¤ | 5 | 40% | 0% | 40% | 80% | **40%** |
| μ•…μ„±-λ³€ν•μ•μ„¤ | 7 | 29% | 14% | 14% | 43% | **57%** |

### λ¶„μ„ κ²°κ³Ό

1. **E4 μ„±λ¥ λ€ν­ ν–¥μƒ**: Accuracy 48.1% β†’ 66.7% (+18.6%p)
2. **E5 FP μµμ†ν™”**: FP 4β†’3 (FPR 26.7%β†’20.0%), μ •μƒ κ°€μ¤‘μΉ ν¨κ³Ό ν™•μΈ
3. **ν•λ“μΉ΄μ΄ν„° κ°μ„ **: νΉμλ¬Έμ/μ§§μ€ λ¬Έμ¥ 33% β†’ 67% (E4 κΈ°μ¤€)
4. **Trade-off λ°μƒ**: E5μ—μ„ FPβ†“ λ€μ‹  FNβ†‘ (5β†’6), Recall ν•λ½

### κ²°λ΅ 

- **FP μµμ†ν™” λ©ν‘**: E5 μ„ νƒ (FP=3, FPR=20.0%)
- **κ· ν• μ΅ν μ„±λ¥**: E4 μ„ νƒ (F1=60.9%, κ°€μ¥ λ†’μ)
- **μ¶”κ°€ κ°μ„ **: E5 κΈ°λ° Threshold νλ‹μΌλ΅ FN κ°μ† μ‹λ„ κ°€λ¥
